# ch1. 헬로 파이썬

## 1.4 파이썬 스크립트 파일

파이썬 인터프리터는 파이썬 코드를 대화식으로 실행해보며 간단한 실험을 수행하기에 좋음

그러나 긴 작업을 수행해야할 때는 파이썬 프로그램을 파일로 저장하고 그 파일을 실행하는 방법이 있음

이를 __파이썬 스크립트 파일__ 이라 함.

### 1.4.1 파일로 저장하기

텍스트 편집기를 열고 hungry.py라는 파일을 작성하고 아래 한 줄을 내용으로 저장함.

``` python
print("I'm hungry")
```

이어서 동일한 위치에서 주피터 ipynb 파일을 만들고

``` python
import hungry
```

위 명령어를 입력시 _I'm hungry_ 가 출력되는 것을 볼 수 있음.

이처럼 파이썬 코드를 담은 파일을 인수로 지정해 파이썬 프로그램을 실행할 수 있음.



### 1.4.2 클래스

지금까지 int와 float, str 등의 자료형은 파이썬이 기본으로 제공하는 자료형.

개발자가 직접 클래스를 정의하면 독자적인 자료형을 만들 수 있고,

그 클래스만의 전용 함수(메서드)와 속성을 정의할 수도 있음.



파이썬에서는 class라는 키워드를 사용하여 클래스를 정의. 

``` python
class 클래스 이름:
	def __init__(self, 인수, ...):
		...
	def 메서드 이름1(self, 인수, ...):
		...
	def 메서드 이름2(self, 인수, ...):
		...
```

클래스 정의에는 \__init__를 이용해 클래스를 초기화하는 방법을 정의함.

이 초기화용 메서드를 **생성자(constructor)**라고도 하며, 클래스의 인스턴스가 만들어질 때 한번만 불림.

파이썬에서는 메서드의 첫 번째 인수로 자신(자신의 인스턴스)을 나타내는 self를 명시적으로 쓰는 것이 특징.



다음 코드를 man.py파일로 저장 후 실행

``` python
class Man:
	def __init__(self, name):
		self.name = name
		print("Initialized!")
		
	def hello(self):
		print("Hello" + self.name + "!")
	
	def goodbye(self):
		print("Good-bye" + self.name + "!")
		
m = Man("David")
m.hello()
m.goodbye()
```

Initialized!

Hello David!

Good-bye David!



Man이라는 새로운 클래스를 정의하고 m이라는 인스턴스(객체)를 생성.

Man의 생성자(초기화 메서드)는 name이라는 인수를 받고, 그 인수로 인스턴스 변수인 self.name을 초기화.

인스턴스 변수는 인스턴스 별로 저장되는 변수.

파이썬에서는 self.name처럼 self 다음에 속성 이름을 써서 인스턴스 변수를 작성하거나 접근할 수 있음.



## 1.5 넘파이

딥러닝을 구현하다보면 배열이나 행렬 계산이 많이 등장. 이번 절에서는 앞으로 사용할 넘파이에 대해서 간략히 설명.

### 1.5.1 넘파이 가져오기

넘파이는 외부 라이브러리. 

여기서 말하는 '외부'는 표준 파이썬에는 포함되지 않는다는 것. 

따라서 우선 넘파이 라이브러리를 쓸 수 있도록 불러와야 함.

``` python
>>> import numpy as np
```

파이썬에서는 라이브러리를 읽기 위해 import 문을 이용.

### 1.5.2 넘파이 배열 생성하기

넘파이 배열을 만들 때는 np.array() 메서드를 이용. 

np.array()는 파이썬의 리스트를 인수로 받아 넘파이 라이브러리가 제공하는 특수한 형태의 배열(numpy.ndarray)을 반환.

```python
>>> x = np.array([1.0, 2.0, 3.0])
>>> print(x)
[1, 2, 3]

>>> type(x)
<class 'numpy.ndarray'>
```



### 1.5.3 넘파이의 산술 연산

넘파이 배열로 산술 연산을 수행하는 예

``` python
>>> x = np.array([1.0, 2.0, 3.0])
>>> y = np.array([2.0, 4.0, 6.0])
>>> x+y
array([3., 6., 9.])

>>> x-y
array([-1., -2., -3.])

>>> x*y
array([2., 8., 18.])

>>> x/y
array([0.5, 0.5, 0.5])
```

여기서 주의할 점은 배열 x와 y의 원소 수가 같다는 것.

두 배열의 원소 수가 같다면 산술 연산은 각 원소에 대해서 행해짐.

(__원소 수가 다르면 오류가 발생__ 하니 원소 수 맞추기는 중요!)

참고로 '원소별 곱셈'은 영어로 'element-wise product'라고 함.



넘파이 배열은 원소별 계산 뿐 아니라 넘파이 배열과 수치 하나(스칼라 값)의 조합으로 된 산술 연산도 수행할 수 있음.

이 경우 스칼라 값과의 계산이 넘파이 배열의 원소별로 한 번씩 수행됨

이러한 기능을 **브로드캐스트**라고 함.

### 1.5.4 넘파이의 N차원 배열

넘파이는 1차원 배열뿐 아니라 다차원 배열도 작성할 수 있음. 

예를 들어 2차원 배열(행렬)은 다음처럼 작성.

``` python
>>> A = np.array([[1, 2], [3,4]])
>>> print(A)
[[1 2]
 [3 4]]

>>> A.shape
(2, 2) # 2 by 2 행렬

>>> A.dtype
dtype('int64')
```

2x2의 A라는 행렬을 작성.

행렬의 형상은 shape으로, 행렬에 담긴 원소의 자료형은 dtype으로 알 수 있음.



행렬의 산술 연산의 예

``` python
>>> B = np.array([[3, 0], [0, 6]])
>>> A + B
array([[4, 2],
       [3, 10]])

>>> A * B
array([[3, 0],
       [0, 24]])
```

배열과 마찬가지로 형상(shape)이 같은 행렬끼리면 행렬의 산술 연산도 대응하는 원소별로 계산. 

행렬과 스칼라값의 산술 연산도 가능. 이때도 배열과 마찬가지로 브로드캐스트 기능이 작동.

``` python
>>> print(A)
[[1 2]
 [3 4]]

>>> A * 10
array([[ 10, 20],
       [ 30, 40]])
```

**Note** 넘파이 배열(np.array)은 N차원 배열을 작성할 수 있음. 1차원 배열, 2차원 배열, 3차원 배열처럼 원하는 차수의 배열을 만드는 것이 가능. 수학에서는 1차원 배열은 **벡터**(vector), 2차원 배열은 **행렬**(matrix)라고 부름.또 벡터와 행렬을 일반화한 것을 **텐서**(tensor)라 함. 이 책에서는 기본적으로 2차원 배열을 '행렬', 3차원 이상의 배열을 '다차원 배열'이라 함.

### 1.5.5 브로드 캐스트

넘파이에서는 형상이 다른 배열끼리도 계산 가능.

앞의 예에서는 2x2 행렬 A에 스칼라값 10을 곱함. 이때 10이라는 스칼라값이 2x2행렬([10, 10], [10, 10])로 확대된 후 연산이 이루어짐. 이러한 기능을 브로드캐스트(broadcast)라고 함.



브로드캐스트의 다른 예

```python
>>> A = np.array([[1, 2], [3, 4]])
>>> B = np.array([10, 20])
>>> A * B
array([[ 10, 40],
       [ 30, 80]])
```



### 1.5.6 원소 접근

원소의 인덱스는 0부터 시작.

각 원소에 접근하려면 다음과 같이 함.

``` python
>>> X = np.array([[51, 55], [14, 19], [0, 4]])
>>> print(X)
[[51 55]
 [14 19]
 [ 0  4]]

>>> X[0]
array([51, 55])

>>> X[0][1]
55
```



for 문으로도 각 원소에 접근할 수 있음

```python
>>> for row in X:
    	print(row)
        
[51 55]
[14 19]
[0 4]
```



또 넘파이는 인덱스를 배열로 지정해 한 번에 여러 원소에 접근할 수도 있음.

```python
>>> X = X.flatten() # X를 1차원 배열로 변환(평탄화)
>>> print(X)
[51 55 14 19 0 4]

>>> X[mp.array([0, 2, 4])] # 인덱스가 0, 2, 4인 원소만 부르기
array([51, 14, 0])
```

이 기법을 응용하면 특정 조건을 만족하는 원소만 얻을 수 있음.

예컨대 다음과 같이 배열 X에서 15 이상인 값만 구할 수 있음

``` python
>>> X > 15
array([ True, True, False, True, False, False], dtype=bool)

>>> X[X>15]
array([51, 55, 19])
```

넘파이 배열에 부등호 연산자를 사용한(앞 예에서 X>15) 결과는 bool 배열임. 

여기에서는 이 bool 배열을 사용해 배열 X에서 True에 해당하는 원소, 즉 값이 15보다 큰 원소만 꺼냄.



**Note** 파이썬 같은 동적 언어는 C나 C++같은 정적 언어(컴파일 언어)보다 처리 속도가 늦다고 함. 실제로 무거운 작업을 할 때는 C나 C++로 작성한 프로그램을 쓰는 편이 좋음. 파이썬은 C나 C++로 쓰인 프로그램을 호출해주는 이른바 '중개자'같은 역할을 함. 넘파이도 주된 처리는 C와 C++로 구현. 그래서 성능을 해치지 않으면서 파이썬의 편리한 문법을 사용 가능.



## 1.6 matplotlib

딥러닝 실험에서는 그래프 그리기와 데이터 시각화도 중요. 

이번 절에서는 그래프를 그리고 이미지를 화면에 표시하는 방법을 설명.



### 1.6.1 단순한 그래프 그리기

그래프를 그리려면 matplotlib의 **pyplot** 모듈을 이용. 

sin함수를 그리는 예

``` python
import numpy as pd
import matplotlib.pyplot as plt

# 데이터 준비
x = np.arange(0, 6, 0.1) # 0에서 6까지 0.1간격으로 생성
y = np.sin(x)

# 그래프 그리기
plt.plot(x, y)
plt.show()
```

이 코드에서는 넘파이의 arange 메서드로 [0, 0.1, 0.2, ... 5.8, 5.9]라는 데이터를 생성하여 변수 x에 할당

그 다음 줄에서는 x의 각 원소에 넘파이의 sin 함수인 np.sin()을 적용하여 변수 y에 할당. 

이제 x와 y를 인수로 plt.plot 메서드를 호출해 그래프를 그림.

마지막으로 plt.show()를 호출해 그래프를 화면에 출력.

![](C:\Users\tuso7\Desktop\md\그림 1-3 sin함수 그래프.png)



### 1.6.2 pyplot의 기능

제목과 각 축의 이름(레이블) 표시 등 pyplot의 다른 기능들과 함께 cos 함수 그래프의 예

```python
import numpy as pd
import matplotlib.pyplot as plt

# 데이터 준비
x = np.arange(0, 6, 0.1) # 0에서 6까지 0.1간격으로 생성
y1 = np.sin(x)
y2 = np.cos(x)

# 그래프 그리기
plt.plot(x, y1, label='sin')
plt.plot(x, y2, linestyple="--", label='cos')
plt.xlabel("x") # x축 이름
plt.xlabel("y") # y축 이름
plt.title('sin & cos') # 그래프 제목
plt.legend()
plt.show()
```

![그림 1-4 sin함수와 cos 함수 그래프](C:\Users\tuso7\Desktop\md\그림 1-4 sin함수와 cos 함수 그래프.png)

### 1.6.3 이미지 표시하기

pyplot에는 이미지를 표시해주는 메서드인 imshow()도 존재.

이미지를 읽어들일 때는 matplotlib.image 모듈의 imread() 메서드를 이용.

``` python
import matplotlib.pyplot as plt
from matplotlib.image import imread

img = imread('./lena.png') # 괄호 안에 이미지 경로와 파일 명을 작성!

plt.imshow(img)
plt.show()
```

![그림 1-5 이미지 표시하기](C:\Users\tuso7\Desktop\md\그림 1-5 이미지 표시하기.png)

## 1.7 정리

| 이번 장에서 배운 내용<br />* 파이썬은 간단하고 익히기 쉬운 프로그래밍 언어다.<br />* 파이썬은 오픈 소스여서 자유롭게 사용할 수 있다.<br />* 파이썬을 실행하는 방식에는 '인터프리터'와 '스크립트 파일' 두 가지가 있다.<br />* 파이썬에서는 함수와 클래스 같은 모듈로 구현을 정리할 수 있다.<br />* 넘파이는 다차원 배열을 다루는 편리한 메서드를 많이 제공한다. |
| ------------------------------------------------------------ |

